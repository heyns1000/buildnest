# BuildNest Queen Bee Pre-Commit Hooks
# Atomic, independent security checks for distributed deployment

repos:
  # Hook-01: Secret Scanning
  - repo: https://github.com/gitleaks/gitleaks
    rev: v8.21.2
    hooks:
      - id: gitleaks
        name: "[Hook-01] Secret Scan"
        exclude: '(?x)^(vendor/|node_modules/|dist/|.*_files/)'

  # Hook-02: Bandwidth Guard (Large Files)
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: check-added-large-files
        name: "[Hook-02] Bandwidth Guard"
        args: ['--maxkb=10000']
        exclude: '(?x)^(vendor/|node_modules/|dist/|.*_files/)'

  # Hook-03: Merge Safety
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: check-merge-conflict
        name: "[Hook-03] Merge Safety"

  # Hook-04: YAML Validation
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: check-yaml
        name: "[Hook-04] YAML Validation"
        exclude: '(?x)^(vendor/|node_modules/|.*_files/)'

  # Hook-05: EOF Normalizer
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: end-of-file-fixer
        name: "[Hook-05] EOF Normalizer"
        exclude: '(?x)^(vendor/|node_modules/|dist/|.*_files/|.*\.min\..*)'

  # Hook-TS: TypeScript Type Safety (for TypeScript projects)
  - repo: local
    hooks:
      - id: typescript-check
        name: "[Hook-TS] TypeScript Type Safety"
        entry: npm run check
        language: system
        files: \.(ts|tsx)$
        pass_filenames: false

  # Hook-ES: ESLint Validation (for TypeScript/JavaScript projects)
  - repo: local
    hooks:
      - id: eslint
        name: "[Hook-ES] ESLint Validation"
        entry: npm run lint
        language: system
        files: \.(ts|tsx|js|jsx)$
        pass_filenames: false

  # Hook-PR: Prettier Format Check
  - repo: local
    hooks:
      - id: prettier-check
        name: "[Hook-PR] Prettier Format Check"
        entry: npm run format:check
        language: system
        files: \.(ts|tsx|js|jsx|json|md)$
        pass_filenames: false

  # CodeNest: Audit Consolidator (runs last)
  - repo: local
    hooks:
      - id: codenest-audit
        name: "[CodeNest] Audit Consolidator"
        entry: python .github/scripts/codenest_aggregator.py
        language: system
        pass_filenames: false
        always_run: true
